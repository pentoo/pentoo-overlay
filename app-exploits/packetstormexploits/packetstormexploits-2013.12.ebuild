# Copyright 1999-2018 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2

EAPI=6

inherit versionator

AVC=( $(get_version_components) )
MY_PV_YYYY="${AVC[0]}"
MY_PV_YY="${AVC[0]:2:4}"
MY_PV_MM="${AVC[1]}"

DESCRIPTION="Archive of packetstorm exploits"
HOMEPAGE="http://packetstormsecurity.net"
IUSE=""

if [[ ${MY_PV_MM} == "12" ]]; then
	#Use yearly archivers
	SRC_URI="https://dl.packetstormsecurity.net/${MY_PV_YY}${MY_PV_MM}-exploits/${MY_PV_YYYY}-exploits.tgz"
else
	#Use monthly archivers
	for MY_M in $(eval echo "{01..$MY_PV_MM}"); do
		SRC_URI="${SRC_URI}  https://dl.packetstormsecurity.net/${MY_PV_YY}${MY_M}-exploits/${MY_PV_YY}${MY_M}-exploits.tgz"
	done
fi

LICENSE="HPND"
SLOT="${MY_PV_YYYY}"

KEYWORDS="amd64 x86 arm"

DEPEND=""
RDEPEND="!app-exploits/packetstormexploits:0"

S="${WORKDIR}"

src_install() {
	insinto /usr/share/exploits/${PN}/
	doins -r *
}

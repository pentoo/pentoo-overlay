# Copyright 1999-2017 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2

EAPI=6

PYTHON_COMPAT=( python2_7 ) ## 3.x seems in the works. 

inherit python-single-r1 inherit git-r3
# distutils-r1 

DESCRIPTION="A cross-platform python based utility to penetrate websites and test them with approximately every angle."
HOMEPAGE="https://github.com/Anon-Exploiter/SiteBroker"
	MY_P=${P}
	EGIT_REPO_URI="https://github.com/Anon-Exploiter/SiteBroker.git"
LICENSE="BSD"
SLOT="0"
KEYWORDS=""

IUSE="-doc -desktopicons"
DEPEND="dev-python/beautifulsoup
	dev-python/requests
    dev-python/lxml
	dev-python/future
	virtual/python-dnspython
	dev-python/colorama"
RDEPEND="${DEPEND}"



S=${WORKDIR}/sitebroker-${PV}/sitebroker

#ewarn " live version may at time break or not recevies pulls frequently may work may bork, the stale version tends too." 

src_prepare() {
### clean up  makefile and friends apear to be nothing but docker linting Q/A testing  & invoking pretty q/a SUITE test wizbangs.
## taking out the trash.... @ /dev/null
	rm -f {Makefile,*.sh,Dockerfile,.travis.yml, .git* ,req*.txt}
	rm -r {./.git*,}  ## drop git dir trash.. so as to not cp into install dirs. 
	eapply_user
}

src_install() {
	# mkdir -m 0755 -p /opt/sitebroker
	# chuck/cp  in /opt/sitebroker/SiteBroker.py & /opt/sitebroker/sitebroker submodules...
	# chmod +X +R fixperms recursively..
	## add docs if user give 2 rats to read them , have a nice day... 
	mkdir -p "${S}"/opt/${PN}
	insinto  "${S}"/opt/${PN}
	doins -r "${S}"/opt/${PN}
#	dobin /opt/${PN}/SiteBroker.py
	dosym /opt/${PN}/SiteBroker.py /usr/bin/sitebroker
	chown -R root:root "${S}/opt/${PN}"
#	fperms -R +x +r {*.py,*.pyc} "${S}"/opt/"${PN}"

	if use doc; then
		einstalldocs /usr/share/doc/${PN}/
		dodoc -r /{README.md,LICENSE}
	fi
	}

# to do update desktop for pentoo 	
#desktop_install() {
#	if use desktopicons; then
#		dodir /usr/share/icons/${PN}/
#		cp  ${FILES}/{sitebroker.png,sitebroker.svg}  /usr/share/icons/${PN}/
#		dodir  /usr/share/applications/${PN}/
#		cp ${FILES}*.desktop  /usr/share/applications/${PN}/
#		fixperms +r +x /usr/share/applications/${PN}/*.desktop
	fi
#}

pkg_postinst(){
	elog "sitebroker-${PV} has installed enjoy.. "
}

#!/sbin/openrc-run
# Copyright 1999-2019 Gentoo Authors
# Distributed under the terms of the GNU General Public License v2

GEX_DBPATH="${GEX_DBPATH:-/var/lib/vuls/go-exploitdb.sqlite3}"
GEX_DBTYPE="${GEX_DBTYPE:-sqlite3}"
GEX_LOGDIR="${GEX_LOGDIR:-/var/log/vuls}"

USER="vuls"
GROUP="vuls"

description="Using go-exploitdb as server mode"
command="/usr/lib/go-gentoo/bin/go-exploitdb"
command_background="true"
command_user="${USER}:${GROUP}"

command_args="server
	--bind=${GEX_HOST:-127.0.0.1}
	--port=${GEX_PORT:-1326}
	--dbpath=${GEX_DBPATH}
	--dbtype=${GEX_DBTYPE}
	--log-dir=${GEX_LOGDIR}
	${GEX_OPTS}"

pidfile="/run/${RC_SVCNAME}.pid"
start_stop_daemon_args="--quiet -1 ${GEX_LOGDIR}/${RC_SVCNAME}.log -2 ${GEX_LOGDIR}/${RC_SVCNAME}.log"
retry="TERM/25/KILL/5"

depend() {
	need net
}

# vim: set ft=gentoo-init-d ts=4 :
